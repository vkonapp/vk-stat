(this["webpackJsonpgroup-stat"]=this["webpackJsonpgroup-stat"]||[]).push([[0],{153:function(e,t,a){e.exports=a(233)},233:function(e,t,a){"use strict";a.r(t);a(154),a(181),a(183),a(184),a(186),a(187),a(188),a(189),a(190),a(191),a(192),a(193),a(195),a(196),a(197),a(198),a(199),a(200),a(201),a(202),a(203),a(204),a(206),a(207),a(208),a(209),a(210),a(211),a(212),a(213),a(214),a(215),a(216),a(217),a(218),a(219),a(220),a(221),a(222),a(223);var n=a(0),r=a.n(n),s=a(67),c=a.n(s),o=a(10),l=a.n(o),i=a(41),u=a.n(i),m=a(68),d=a(13),b=(a(232),a(69)),f=["75 170 85","200 190 80","200 190 80","200 190 80","80 200 139"],p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.75;return"rgb("+f[e%f.length]+" / "+t+")"},v={subscribed:"fa-user-alt",likes:"fa-heart",comments:"fa-comment",view:"fa-eye"};var h=function(e){var t=e.stat,a=e.sortOrder,n=e.sortParam;return t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"likes";return e.sort((function(e,n){return"asc"==t&&(n=[e,e=n][0]),e[a]>n[a]?-1:e[a]<n[a]?1:0}))}(t,a,n),console.log(t,n),0==t.length?r.a.createElement("div",{id:"board",style:{color:"white"}},"Load..."):r.a.createElement("div",{id:"board"},t.map((function(e,t){return r.a.createElement("div",{className:"item"},r.a.createElement("img",{src:e.img}),r.a.createElement("div",{className:"shadow",style:{background:p(t),boxShadow:"0 0 20px "+p(t,.1)}}),r.a.createElement("div",{className:"info"},r.a.createElement("span",{className:"name"},e.name),r.a.createElement("i",{className:"fas "+v[n],"aria-hidden":"true"},r.a.createElement("span",null,function(e){var t="";return(e=Number(e))>=1e9?(e/=1e9,t=" B"):e>=1e6&&e<1e9?(e/=1e6,t=" M"):e>=1e3&&e<1e6&&(e/=1e3,t=" K"),(e=""!=t&&e%1!=0?e.toFixed(1):Math.ceil(e))+" "+t}(e[n])))))})))},g=function(e){var t=e.getStat;function a(e){var a=new Date,n=new Date;switch(localStorage.time=e,e){case"today":a.setMinutes(0),a.setHours(0);break;case"yestoday":n.setMinutes(0),n.setHours(0),a=new Date(n-864e5);break;case"week":var r=n.getDay(),s=n.getDate()-r+(0==r?-6:1);a=new Date(a.setDate(s));break;case"month":a.setMinutes(0),a.setHours(0),a.setDate(1);break;case"year":a.setMinutes(0),a.setHours(0),a.setDate(1),a.setMonth(0);break;case"all_time":a=0,n=new Date}console.log(Math.floor(a/1e3),a,n,Math.floor(n/1e3)),t(Math.floor(a/1e3),Math.floor(n/1e3))}return Object(n.useEffect)((function(){a(localStorage.time)}),[]),r.a.createElement("select",{defaultValue:localStorage.time||"all_time",onChange:function(e){return a(e.target.value)}},r.a.createElement("option",{value:"today"},"\u0421\u0435\u0433\u043e\u0434\u043d\u044f"),r.a.createElement("option",{value:"yestoday"},"\u0412\u0447\u0435\u0440\u0430"),r.a.createElement("option",{value:"week"},"\u041d\u0435\u0434\u0435\u043b\u044e"),r.a.createElement("option",{value:"month"},"\u041c\u0435\u0441\u044f\u0446"),r.a.createElement("option",{value:"year"},"\u0413\u043e\u0434"),r.a.createElement("option",{value:"all_time"},"\u0412\u0441\u0435 \u0432\u0440\u0435\u043c\u044f"))},E=(a(234),["subscribed","unsubscribed","likes","comments"]),k=function(e){var t=e.token,a=e.group,s=Object(n.useState)([]),c=Object(d.a)(s,2),o=c[0],i=c[1],u=Object(n.useState)(localStorage.sortParam||"likes"),m=Object(d.a)(u,2),f=m[0],p=m[1],v=Object(n.useState)(localStorage.sortOrder||"desc"),k=Object(d.a)(v,2),O=k[0],j=k[1],y=Object(n.useState)({likes:0,subscribed:0,comments:0}),_=Object(d.a)(y,2),S=_[0],w=_[1],M={likes:0,subscribed:0,comments:0};function x(e){var t="";return(e=Number(e))>=1e9?(e/=1e9,t=" B"):e>=1e6&&e<1e9?(e/=1e6,t=" M"):e>=1e3&&e<1e6&&(e/=1e3,t=" K"),(e=""!=t&&e%1!=0?e.toFixed(1):Math.ceil(e))+" "+t}function D(e){p(e),localStorage.sortParam=e}return r.a.createElement("div",null,r.a.createElement("header",null,r.a.createElement("ul",{id:"menu"},r.a.createElement("li",{onClick:function(){D("subscribed")}},r.a.createElement("i",{className:"fas fa-user-alt"}),r.a.createElement("span",null,x(S.subscribed))),r.a.createElement("li",{onClick:function(){D("likes")}},r.a.createElement("i",{className:"fas fa-heart"}),r.a.createElement("span",null,x(S.likes))),r.a.createElement("li",{onClick:function(){D("comments")}},r.a.createElement("i",{className:"fas fa-comment"}),r.a.createElement("span",null,x(S.comments))),r.a.createElement("li",null,r.a.createElement("span",null,"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430 \u0437\u0430: "),r.a.createElement(g,{getStat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Math.floor(+new Date/1e3);i([]),M={likes:0,subscribed:0,comments:0};var r=0,s=100;setTimeout((function c(){var o=a[r];l.a.send("VKWebAppCallAPIMethod",{method:"stats.get",params:{group_id:o.id,timestamp_from:e,timestamp_to:n,interval:"all",access_token:t,v:"5.86"}}).then((function(e){var t=e.response[0].activity;for(var n in void 0==t&&(t={}),E.forEach((function(e){e in t==0&&(t[e]=0)})),t.subscribed=t.subscribed-t.unsubscribed,i((function(e){return[].concat(Object(b.a)(e),[{id:o.id,name:o.name,img:o.photo_200,screen_name:o.screen_name,likes:t.likes,subscribed:t.subscribed,comments:t.comments}])})),M)M[n]+=t[n];w(M),++r<a.length&&setTimeout(c,s)})).catch((function(e){console.log(e.error_data.error_code),1==e.error_data.error_code&&(s+=100,setTimeout(c,s))}))}),s)}}),r.a.createElement("select",{defaultValue:O,onChange:function(e){var t;t=e.target.value,j(t),localStorage.sortOrder=t}},r.a.createElement("option",{value:"desc"},"\u041f\u043e \u0443\u0431\u044b\u0432\u0430\u043d\u0438\u044e"),r.a.createElement("option",{value:"asc"},"\u041f\u043e \u0432\u043e\u0437\u0440\u0430\u0441\u0442\u0430\u043d\u0438\u044e"))))),r.a.createElement(h,{stat:o,sortOrder:O,sortParam:f}))},O=function(){var e=Object(n.useState)(null),t=Object(d.a)(e,2),a=(t[0],t[1]),s=Object(n.useState)(null),c=Object(d.a)(s,2),o=c[0],i=c[1],b=Object(n.useState)({begin:0,end:0}),f=Object(d.a)(b,2),p=(f[0],f[1],Object(n.useState)(null)),v=Object(d.a)(p,2),h=v[0],g=v[1];return Object(n.useEffect)((function(){function e(){return(e=Object(m.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.a.send("VKWebAppGetUserInfo");case 2:return t=e.sent,a(t),e.next=6,l.a.send("VKWebAppGetAuthToken",{app_id:7715875,scope:"friends,status,groups,stats"});case 6:return n=e.sent.access_token,g(n),e.next=10,l.a.send("VKWebAppCallAPIMethod",{method:"groups.get",params:{extended:1,access_token:n,v:"5.86"}});case 10:"response"in(r=e.sent)&&(r=r.response.items.filter((function(e){return 1==e.is_admin}))),i(r);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l.a.subscribe((function(e){var t=e.detail,a=t.type,n=t.data;if("VKWebAppUpdateConfig"===a){var r=document.createAttribute("scheme");r.value=n.scheme?n.scheme:"client_light",document.body.attributes.setNamedItem(r)}})),function(){e.apply(this,arguments)}()}),[]),null!=o?r.a.createElement(k,{token:h,group:o}):r.a.createElement("p",{style:{padding:"30px",opacity:.7}},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430...")};l.a.send("VKWebAppInit"),c.a.render(r.a.createElement(O,null),document.getElementById("root"))}},[[153,1,2]]]);
//# sourceMappingURL=main.8315eb48.chunk.js.map